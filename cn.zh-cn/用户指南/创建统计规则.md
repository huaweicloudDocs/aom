# 创建统计规则<a name="ZH-CN_TOPIC_0136398960"></a>

日志包含了系统性能及业务等信息，例如，关键词ERROR的多少反应了系统的健康度，关键词BUY的多少反应了业务的成交量等，当您需要了解这些信息时，可创建统计规则。统计规则创建成功后，AOM能够针对您配置的关键词周期性地进行统计，并生成指标数据，以便您实时了解系统性能及业务等信息。

## 注意事项<a name="section31941717191818"></a>

统计规则是以日志桶为单位，创建统计规则前需确保至少已创建了一个日志桶，操作详见[添加日志桶](添加日志桶.md)，否则无法创建统计规则。

## 创建统计规则<a name="section72914485352"></a>

1.  登录[应用运维管理](https://console.huaweicloud.com/aom/#/aom/ams/summary)。
2.  在左侧导航栏中选择“日志管理 \> 统计规则”，单击“创建统计规则”。
3.  <a name="li62382120594"></a>您需先创建一个日志桶。单击“新建日志桶”进行创建，操作详见[添加日志桶](添加日志桶.md)。

    若您已创建过日志桶，请跳过该步骤。

4.  选择规则类型，设置规则名称、关键词，选择[3](#li62382120594)中创建的日志桶，单击“保存”，如下图所示。

    统计规则以日志桶为单位， AOM会周期统计关键词在日志桶的日志文件中出现的条数，并生成日志指标。

    **图 1**  创建统计规则<a name="fig17203656155115"></a>  
    ![](figures/创建统计规则.png "创建统计规则")

    统计规则创建完成后，会生成以统计规则名称命名的指标。

5.  （可选）查看指标数据。
    -   方式一：在“统计规则”界面查看指标数据，如[图2](#fig108335152819)所示。

        “指标”列的缩略图展示了最近1小时内（统计周期为1分钟）指标的趋势，其后的数字为缩略图上最后一个非空的指标值。

        当需要查看更详细的指标数据时，可双击缩略图以对其进行放大。放大后，可在界面上方设置时间范围和统计周期，查看不同时间范围和统计周期下的指标数据。还可在界面上方单击“添加阈值规则”，对该指标添加阈值规则，当满足阈值条件时产生阈值告警，以便您能在第一时间发现异常并进行处理。

        **图 2**  方式一<a name="fig108335152819"></a>  
        ![](figures/方式一.png "方式一")

    -   方式二：在“指标监控”界面查看指标数据，如[图3](#fig182912014432)所示。

        在左侧导航栏中选择“视图管理 \> 指标监控”，在左侧指标树中单击“自定义指标 \> ALSAlarm”，找到以统计规则名称命名的指标，然后查看指标趋势。

        在“指标监控”界面右上方您还可对该指标执行添加到仪表盘、添加阈值规则、导出监控报告等操作。

        **图 3**  方式二<a name="fig182912014432"></a>  
        ![](figures/方式二.png "方式二")



## 更多统计规则操作<a name="section696815451214"></a>

创建完统计规则后，您还可以执行[表1](#table208603242140)中的操作。

**表 1**  相关操作

<a name="table208603242140"></a>
<table><thead align="left"><tr id="row686212412146"><th class="cellrowborder" valign="top" width="20%" id="mcps1.2.3.1.1"><p id="p986392418148"><a name="p986392418148"></a><a name="p986392418148"></a>操作</p>
</th>
<th class="cellrowborder" valign="top" width="80%" id="mcps1.2.3.1.2"><p id="p1864162431412"><a name="p1864162431412"></a><a name="p1864162431412"></a>说明</p>
</th>
</tr>
</thead>
<tbody><tr id="row28351116204411"><td class="cellrowborder" valign="top" width="20%" headers="mcps1.2.3.1.1 "><p id="p188371616184419"><a name="p188371616184419"></a><a name="p188371616184419"></a>查看统计规则</p>
</td>
<td class="cellrowborder" valign="top" width="80%" headers="mcps1.2.3.1.2 "><p id="p148371164449"><a name="p148371164449"></a><a name="p148371164449"></a>在“规则名称”列单击统计规则名称，查看统计规则的详细信息。</p>
</td>
</tr>
<tr id="row2867102411412"><td class="cellrowborder" valign="top" width="20%" headers="mcps1.2.3.1.1 "><p id="p1686892411420"><a name="p1686892411420"></a><a name="p1686892411420"></a>修改统计规则</p>
</td>
<td class="cellrowborder" valign="top" width="80%" headers="mcps1.2.3.1.2 "><p id="p28691224111414"><a name="p28691224111414"></a><a name="p28691224111414"></a>单击“操作”列的“编辑”。</p>
</td>
</tr>
<tr id="row8870142481413"><td class="cellrowborder" valign="top" width="20%" headers="mcps1.2.3.1.1 "><p id="p1187182410145"><a name="p1187182410145"></a><a name="p1187182410145"></a>删除统计规则</p>
</td>
<td class="cellrowborder" valign="top" width="80%" headers="mcps1.2.3.1.2 "><a name="ul2872122416142"></a><a name="ul2872122416142"></a><ul id="ul2872122416142"><li>删除一个统计规则：单击“操作”列的“删除”。</li><li>删除一个或多个统计规则：选中一个或多个统计规则前的复选框，单击页面上方的“删除”。</li></ul>
<div class="note" id="note0875324161414"><a name="note0875324161414"></a><a name="note0875324161414"></a><span class="notetitle"> 说明： </span><div class="notebody"><p id="p2875152471417"><a name="p2875152471417"></a><a name="p2875152471417"></a>删除统计规则后，您的日志桶、日志文件均不会被删除。</p>
</div></div>
</td>
</tr>
<tr id="row1279913272455"><td class="cellrowborder" valign="top" width="20%" headers="mcps1.2.3.1.1 "><p id="p27999274456"><a name="p27999274456"></a><a name="p27999274456"></a>查看阈值规则</p>
</td>
<td class="cellrowborder" valign="top" width="80%" headers="mcps1.2.3.1.2 "><p id="p7356448124415"><a name="p7356448124415"></a><a name="p7356448124415"></a>“阈值规则”列展示了该统计规则生成的指标关联的所有阈值规则，多个阈值规则间使用空格分割。</p>
<p id="p580022717458"><a name="p580022717458"></a><a name="p580022717458"></a>单击阈值规则名称，跳转到阈值规则界面，可查看该阈值规则的详细信息。</p>
</td>
</tr>
</tbody>
</table>

